{% extends 'admins/index.html' %}
{% block main_admincontent %}

<div class="p-4 sm:ml-64">
  <div class="p-6 rounded-lg bg-white shadow-md">

    <!-- Header -->
    <h1 class="text-3xl font-bold text-orange-600 mb-6">Admin Dashboard</h1>

    <!-- Stat Cards -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">

      <div class="bg-orange-100 p-5 rounded-lg shadow hover:shadow-xl transition">
        <h2 class="text-lg font-semibold text-orange-700">Total Sales</h2>
        <p class="text-3xl font-bold mt-2">Rs. {{ total_sales }}</p>
      </div>

      <div class="bg-orange-100 p-5 rounded-lg shadow hover:shadow-xl transition">
        <h2 class="text-lg font-semibold text-orange-700">Total Users</h2>
        <p class="text-3xl font-bold mt-2">{{ total_users }}</p>
      </div>

      <div class="bg-orange-100 p-5 rounded-lg shadow hover:shadow-xl transition">
        <h2 class="text-lg font-semibold text-orange-700">Total Orders</h2>
        <p class="text-3xl font-bold mt-2">{{ total_orders }}</p>
      </div>

      <div class="bg-orange-100 p-5 rounded-lg shadow hover:shadow-xl transition">
        <h2 class="text-lg font-semibold text-orange-700">Total Products</h2>
        <p class="text-3xl font-bold mt-2">{{ total_products }}</p>
      </div>

    </div>


    <!-- Charts -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">

      <div class="bg-white border border-orange-200 rounded-lg p-4 shadow">
        <h2 class="text-lg font-semibold text-orange-600 mb-2">ðŸ“ˆ Sales Overview</h2>
        <canvas id="salesChart"></canvas>
      </div>

      <div class="bg-white border border-orange-200 rounded-lg p-4 shadow">
        <h2 class="text-lg font-semibold text-orange-600 mb-2">ðŸ“Š Orders Trend</h2>
        <canvas id="ordersChart"></canvas>
      </div>

    </div>

    <!-- Top Selling Products -->
    <div class="bg-white border border-orange-200 rounded-lg p-6 shadow mb-10">
      <h2 class="text-xl font-bold text-orange-600 mb-4">ðŸ”¥ Top 5 Selling Products</h2>
      <ul class="list-disc pl-5 text-orange-700 font-medium">
        {% for product in top_products %}
          <li>{{ product.name }} (Sold: {{ product.sold }})</li>
        {% empty %}
          <li>No sales data available.</li>
        {% endfor %}
      </ul>
    </div>

  </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Prepare labels and values safely

  // Sales Chart (Line)
  const ctx1 = document.getElementById('salesChart').getContext('2d');
  new Chart(ctx1, {
    type: 'line',
    data: {
      labels: salesLabels,
      datasets: [{
        label: 'Sales (Rs.)',
        data: salesValues,
        borderColor: '#f97316',
        backgroundColor: 'rgba(249,115,22,0.2)',
        tension: 0.3,
        fill: true,
        pointRadius: 5,
        pointBackgroundColor: '#f97316'
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          display: true,
          position: 'top'
        }
      }
    }
  });

  // Orders Chart (Bar)
  const ctx2 = document.getElementById('ordersChart').getContext('2d');
  new Chart(ctx2, {
    type: 'bar',
    data: {
      labels: salesLabels,
      datasets: [{
        label: 'Orders',
        data: salesValues,
        backgroundColor: '#fb923c'
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          display: true,
          position: 'top'
        }
      },
      scales: {
        y: {
          beginAtZero: true
        }
      }
    }
  });
</script>



{% endblock %}
